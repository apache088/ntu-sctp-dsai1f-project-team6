version: 1
default_environment: dev
project_id: f9c0be5b-9e0e-450c-bfa6-051308009686
environments:
- name: dev
- name: staging
- name: prod
plugins:
  extractors:
  - name: tap-duckdb
    variant: meltanolabs
    pip_url: git+https://github.com/MeltanoLabs/tap-duckdb.git
    config:
      flattening_enabled: true
      flattening_max_depth: 1
      path: ${DUCKDB_PATH}
  loaders:
  - name: target-bigquery
    variant: z3z1ma
    pip_url: git+https://github.com/z3z1ma/target-bigquery.git
    config:
      project: ${BIGQUERY_PROJECT}
      dataset: ${BIGQUERY_DATASET}
      credentials_path: ${BIGQUERY_CREDENTIALS_PATH}
      method: batch_job
      denormalized: true
      flattening_enabled: true
      flattening_max_depth: 1
        # Enable upsert (merge) functionality
      write_disposition: MERGE  # or WRITE_TRUNCATE (see options below)
      merge_on_columns: ["ride_id"]  # Primary key column(s)
      dedupe_on: "ride_id"          # Optional: Deduplicate before merging        # Columns to match for updates
